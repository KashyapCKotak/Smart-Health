#!/usr/bin/env Rscript
args = commandArgs(trailingOnly=TRUE)

if (length(args)==0) {
  stop("19 arguments must be supplied ", call.=FALSE)
} else{
  
  thetaVector <- list()
  thetaVector[[1]] <- array(1,dim = c(6,19))
  thetaVector[[2]] <- matrix(1,nrow = 4,ncol = 7)
  thetaVector[[3]] <- matrix(1,nrow = 1,ncol = 5)
  
  # to store actual values of computation
  nodes1 <- matrix(2,nrow = 19,ncol = 1)
  nodes2 <- matrix(2,nrow = 7,ncol = 1)
  nodes3 <- matrix(2,nrow = 5,ncol = 1)
  
  mean1 <- c(54.1107784,6.0036997,1.9133447,106.6455518,0.9830368,109.9385800)
  sd1 <- c(17.8917047,24.5721684,0.9523384,44.2637176,0.2264368,40.8490490)
  nodes1 <- as.numeric(as.character(args))
  nodes1[2] <- (nodes1[2]-mean1[1])/sd1[1]
  nodes1[15] <- (nodes1[15]-mean1[2])/sd1[2]
  nodes1[16] <- (nodes1[16]-mean1[3])/sd1[3]
  nodes1[17] <- (nodes1[17]-mean1[4])/sd1[4]
  nodes1[18] <- (nodes1[18]-mean1[5])/sd1[5]
  nodes1[19] <- (nodes1[19]-mean1[6])/sd1[6]
  thetaVector[[1]][1,] <- c( 1.2563514,1.92714604,0.5093906,1.002690679, 3.0169420,-1.969352,3.0004711,-2.9158798,0.9574037, 0.1023942, 2.3742892, 1.4812719, 1.0000811, 1.012432, 2.967190, 3.64448801,-3.6153029, 1.868055, 0.88394823)
  thetaVector[[1]][2,] <- c( 0.6585676,2.42964974,1.5643333,0.928266337, 0.9743324, 2.983564,2.9739286,-4.0945984,2.0536804, 0.2937956, 0.3942514, 3.0008712, 0.9999795,-2.009324,-3.171764, 0.90509359,-3.2406605, 4.035319, 0.06495564)
  thetaVector[[1]][3,] <- c( 1.8546938,1.51089506,2.4938491,1.062371130, 1.2963347, 2.999111,3.9959201,-5.0247541,0.9962965, 0.3026981, 3.9980554, 0.1022557,-0.2000006,-1.110427, 1.027740, 0.03432248, 1.9088940,-2.047950,-3.17403013)
  thetaVector[[1]][4,] <- c( 3.8203266,0.35803083,3.2114193,1.149182854,-1.9789112,-2.981904,2.0211961,-2.8880396,3.9925839, 0.4053251, 0.1758535,-0.3011032, 1.0000004,-1.989034, 2.829365,-1.61401078,-0.7816416, 2.729097,-2.57435977)
  thetaVector[[1]][5,] <- c( 1.8048311,0.07239427,1.1536689,2.841124649,-2.9800316,-3.976729,0.8867239,-1.6741359,2.7344680, 0.2032065,-0.1836640, 1.8832349, 3.0000001,-2.906840,-3.667679, 4.04434333,-1.2087827, 2.349286, 1.68559461)
  thetaVector[[1]][6,] <- c(-2.6092535,0.83246905,3.8111071,0.007707011,-0.2176694,-1.067425,0.9758773, 0.1490326,1.9850791,-2.0019956, 3.0159999, 0.2958298, 3.0000000, 0.973493,-1.969505,-3.47468103, 1.7450622,-2.837343, 3.61993421)
  
  thetaVector[[2]][1,] <- c(1.177018, 2.050553,0.5617695,1.0558232, 3.0586885,-1.847656,3.067528)
  thetaVector[[2]][2,] <- c(1.011351, 2.504347,1.4994795,0.9956118, 0.9943599, 3.007210,3.000113)
  thetaVector[[2]][3,] <- c(2.005379, 1.502186,2.5003373,1.1012930, 1.3017714, 3.002088,4.000985)
  thetaVector[[2]][4,] <- c(1.394688,-2.089218,2.0408072,0.3374123,-1.8145323,-4.897482,2.186942)
  
  thetaVector[[3]][1,] <- c(-1.090837,-0.5911144,-1.073143,-1.082906,4.618809)
  
  # (1,45,0,0,0,0,0,0,0,0,0,0,0,0,1.90,1,82,0.73,112)
  # nodes1 <-as.numeric(test_set[i,c(-10)])                   # input layer i.e layer1
  nodes2 <- c(1,as.numeric(thetaVector[[1]] %*% nodes1))     # hidden layer1 i.e layer2
  nodes2[-1] <- 1/(1+exp(-nodes2[-1]))
  nodes3 <- c(1,as.numeric(thetaVector[[2]] %*% nodes2))     # hidden layer2 i.e layer3
  nodes3[-1] <- 1/(1+exp(-nodes3[-1]))
  h <- sum(as.numeric(thetaVector[[3]] * nodes3))               # output layer i.e layer4
  h <- 1/(1+exp(-h))
  
  # saving the vector in a .txt file
  thetaVectorSave <- h
  write(thetaVectorSave, file = "thyroid_output.txt",
        ncolumns = if(is.character(thetaVectorSave)) 1 else 11,
        append = FALSE, sep = " ")
}
